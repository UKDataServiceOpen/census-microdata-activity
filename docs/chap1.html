<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R code for module activity – Census microdata activity - R code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f410b66b4933f15108f8fa93e83e019d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="ukds_long.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap1.html"><span class="chapter-title">R code for module activity</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://ukdataservice.ac.uk/" class="sidebar-logo-link">
      <img src="./pics/UKDS_Logos_Col_Grey_300dpi.png" alt="UK Data Service Logo and link to website" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./pics/UKDS_Logos_Col_Grey_300dpi.png" alt="UK Data Service Logo and link to website" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">R code for module activity</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#install-and-load-the-main-packages" id="toc-install-and-load-the-main-packages" class="nav-link active" data-scroll-target="#install-and-load-the-main-packages">1- Install and load the main packages</a></li>
  <li><a href="#load-the-dataset-and-make-a-copy" id="toc-load-the-dataset-and-make-a-copy" class="nav-link" data-scroll-target="#load-the-dataset-and-make-a-copy">2- Load the dataset and make a copy</a></li>
  <li><a href="#drop-unnecessary-variables" id="toc-drop-unnecessary-variables" class="nav-link" data-scroll-target="#drop-unnecessary-variables">3- Drop unnecessary variables</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">4- Exploratory analysis</a></li>
  <li><a href="#regression-model" id="toc-regression-model" class="nav-link" data-scroll-target="#regression-model">5 Regression model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">R code for module activity</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Quarto source</button></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="install-and-load-the-main-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-and-load-the-main-packages">1- Install and load the main packages</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">#### Load the packages if installed; install them if not present </span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>pkg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, </span>
<span id="cb1-4"><a href="#cb1-4"></a>         <span class="st">"ggplot2"</span>, </span>
<span id="cb1-5"><a href="#cb1-5"></a>         <span class="st">"ggrepel"</span>, </span>
<span id="cb1-6"><a href="#cb1-6"></a>         <span class="st">"patchwork"</span>, </span>
<span id="cb1-7"><a href="#cb1-7"></a>         <span class="st">"gridExtra"</span>, </span>
<span id="cb1-8"><a href="#cb1-8"></a>         <span class="st">"haven"</span>,   <span class="do">### Import Stata and SPSS datasets</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>         <span class="st">"viridis"</span>  <span class="do">### colourblind friendly palette</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="cf">for</span> (p <span class="cf">in</span> pkg) {</span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> T)) {</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="fu">library</span>(p, <span class="at">character.only =</span> T)</span>
<span id="cb1-16"><a href="#cb1-16"></a>  }</span>
<span id="cb1-17"><a href="#cb1-17"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="load-the-dataset-and-make-a-copy" class="level2">
<h2 class="anchored" data-anchor-id="load-the-dataset-and-make-a-copy">2- Load the dataset and make a copy</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>publicmicrodatateachingsample <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"data/publicmicrodatateachingsample.sav"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>census2021teaching <span class="ot">&lt;-</span> publicmicrodatateachingsample</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Important: Remember to change the filepath to your dataset accordingly.</p>
<p>If the <strong>read_sav</strong> code does not work, you can use the <strong>Import Dataset</strong> button in the RStudio Environment Pane to load the dataset in R.</p>
</section>
<section id="drop-unnecessary-variables" class="level2">
<h2 class="anchored" data-anchor-id="drop-unnecessary-variables">3- Drop unnecessary variables</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>census2021teaching <span class="ot">&lt;-</span> census2021teaching[,<span class="fu">c</span>(<span class="st">"health_in_general"</span>,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                                            <span class="st">"hours_per_week_worked"</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>                                            <span class="st">"resident_age_7d"</span>,<span class="st">"sex"</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                                            <span class="st">"ethnic_group_tb_6a"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                                            <span class="st">"approx_social_grade"</span>)]</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="fu">head</span>(census2021teaching)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="fu">dim</span>(census2021teaching)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Click to view results
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  health_in_general    hours_per_week_worked             resident_age_7d sex    
  &lt;dbl+lbl&gt;            &lt;dbl+lbl&gt;                         &lt;dbl+lbl&gt;       &lt;dbl+l&gt;
1 1 [Very good health]  4 [Full-time: 49 or more hours … 4 [Aged 35 to … 2 [Mal…
2 2 [Good health]      -8 [Does not apply]               7 [Aged 65 yea… 2 [Mal…
3 2 [Good health]      -8 [Does not apply]               7 [Aged 65 yea… 2 [Mal…
4 3 [Fair health]      -8 [Does not apply]               7 [Aged 65 yea… 1 [Fem…
5 2 [Good health]      -8 [Does not apply]               2 [Aged 16 to … 2 [Mal…
6 4 [Bad health]       -8 [Does not apply]               7 [Aged 65 yea… 2 [Mal…
# ℹ 2 more variables: ethnic_group_tb_6a &lt;dbl+lbl&gt;,
#   approx_social_grade &lt;dbl+lbl&gt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 604351      6</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">4- Exploratory analysis</h2>
<section id="univariate-analysis" class="level3">
<h3 class="anchored" data-anchor-id="univariate-analysis">4.1- Univariate analysis</h3>
<section id="univariate-analysis-for-health-in-general-and-hours-worked" class="level4">
<h4 class="anchored" data-anchor-id="univariate-analysis-for-health-in-general-and-hours-worked">4.1.1 Univariate analysis for health in general and hours worked</h4>
<section id="frequencies-for-health-in-general-and-hours-worked" class="level5">
<h5 class="anchored" data-anchor-id="frequencies-for-health-in-general-and-hours-worked">Frequencies for health in general and hours worked</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">### Raw values</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="do">### Labelled  values</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Click to view results
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    -8      1      2      3      4      5 
  6989 289229 200500  76185  24306   7142 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                    Does not apply Part-time: 15 hours or less worked 
                            326132                              28680 
  Part-time: 16 to 30 hours worked   Full-time: 31 to 48 hours worked 
                             54414                             164603 
Full-time: 49 or more hours worked 
                             30522 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="distribution-of-self-rated-health-and-hours-worked" class="level5">
<h5 class="anchored" data-anchor-id="distribution-of-self-rated-health-and-hours-worked">Distribution of self-rated health and hours worked</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">round</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>      <span class="fu">prop.table</span>(</span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="fu">table</span>(</span>
<span id="cb9-4"><a href="#cb9-4"></a>          <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general</span>
<span id="cb9-5"><a href="#cb9-5"></a>                )</span>
<span id="cb9-6"><a href="#cb9-6"></a>      )</span>
<span id="cb9-7"><a href="#cb9-7"></a>      ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>      <span class="dv">1</span>) </span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="fu">round</span>(</span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">prop.table</span>(</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="fu">table</span>(</span>
<span id="cb9-13"><a href="#cb9-13"></a>      <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb9-14"><a href="#cb9-14"></a>      )</span>
<span id="cb9-15"><a href="#cb9-15"></a>    ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Click to view results
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
  Does not apply Very good health      Good health      Fair health 
             1.2             47.9             33.2             12.6 
      Bad health  Very bad health 
             4.0              1.2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                    Does not apply Part-time: 15 hours or less worked 
                              54.0                                4.7 
  Part-time: 16 to 30 hours worked   Full-time: 31 to 48 hours worked 
                               9.0                               27.2 
Full-time: 49 or more hours worked 
                               5.1 </code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- You can also calculate these frequencies and percentages with appropriate labels. -->
</section>
<section id="frequencies-and-percentages-with-labels-for-health-in-general-and-hours-worked" class="level5">
<h5 class="anchored" data-anchor-id="frequencies-and-percentages-with-labels-for-health-in-general-and-hours-worked">Frequencies and percentages with labels for health in general and hours worked</h5>
<p>You can also generate pie charts for better visualization</p>
</section>
</section>
</section>
<section id="a-pie-chart-for-self-rated-general-health" class="level3">
<h3 class="anchored" data-anchor-id="a-pie-chart-for-self-rated-general-health">a) Pie chart for self-rated general health</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>h1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>            <span class="fu">prop.table</span>(</span>
<span id="cb12-3"><a href="#cb12-3"></a>              <span class="fu">table</span>(</span>
<span id="cb12-4"><a href="#cb12-4"></a>                <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb12-5"><a href="#cb12-5"></a>                )</span>
<span id="cb12-6"><a href="#cb12-6"></a>              ),<span class="dv">1</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>          )</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a>h1_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(h1)</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="fu">names</span>(h1_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"srh"</span>, <span class="st">"pct"</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="fu">pie</span>(h1_df<span class="sc">$</span>pct,</span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(h1_df<span class="sc">$</span>srh, <span class="at">sep =</span> <span class="st">" "</span>, h1_df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb12-15"><a href="#cb12-15"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb12-16"><a href="#cb12-16"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb12-17"><a href="#cb12-17"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(h1_df<span class="sc">$</span>srh)), </span>
<span id="cb12-18"><a href="#cb12-18"></a>    <span class="at">main =</span> <span class="st">"Self-rated general health"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Click to view results
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/p1.2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="b-pie-chart-for-hours-worked" class="level3">
<h3 class="anchored" data-anchor-id="b-pie-chart-for-hours-worked">b) Pie chart for Hours worked</h3>
<section id="b.1-create-a-labelled-hours-worked-variable" class="level5">
<h5 class="anchored" data-anchor-id="b.1-create-a-labelled-hours-worked-variable">b.1) Create a labelled hours worked variable</h5>
<div class="cell">
<details class="code-fold">
<summary>View output</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>h2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>            <span class="fu">prop.table</span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>              <span class="fu">table</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>                <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked))</span>
<span id="cb13-5"><a href="#cb13-5"></a>              ),<span class="dv">1</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>          )</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>h2_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(h2)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="fu">names</span>(h2_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hpw"</span>, <span class="st">"pct"</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>p2<span class="ot">&lt;-</span><span class="fu">pie</span>(h2_df<span class="sc">$</span>pct,</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(h2_df<span class="sc">$</span>hpw, <span class="at">sep =</span> <span class="st">" "</span>, h2_df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(h2_df<span class="sc">$</span>hpw)), </span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="at">main =</span> <span class="st">"Hours worked per week"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/p2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="transformation-of-variable-health-in-general" class="level3">
<h3 class="anchored" data-anchor-id="transformation-of-variable-health-in-general">4.1.1.1 Transformation of variable Health in general</h3>
<p>Create a new variable called <strong>health_binary</strong> by regrouping health in general in two broader categories: <strong>Good or very good health</strong> and <strong>Poor health</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>census2021teaching<span class="sc">$</span>health_binary <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  census2021teaching<span class="sc">$</span>health_in_general <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="st">"Good or very good health"</span>,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">ifelse</span>(census2021teaching<span class="sc">$</span>health_in_general <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="st">"Poor health"</span>, <span class="cn">NA</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="drop-rows-where-health_in_general--8-does-not-apply" class="level5">
<h5 class="anchored" data-anchor-id="drop-rows-where-health_in_general--8-does-not-apply">Drop rows where health_in_general = -8 (Does not apply)</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>census2021teaching <span class="ot">&lt;-</span>census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>                      <span class="fu">filter</span>(health_in_general <span class="sc">!=</span> <span class="sc">-</span><span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="check-the-new-variables-distribution" class="level5">
<h5 class="anchored" data-anchor-id="check-the-new-variables-distribution">Check the new variable’s distribution</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>health_binary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Good or very good health              Poor health 
                  489729                   107633 </code></pre>
</div>
</div>
</section>
<section id="create-variable-poor_health-and-check-its-distribution" class="level5">
<h5 class="anchored" data-anchor-id="create-variable-poor_health-and-check-its-distribution">Create variable <strong>Poor_health</strong> and check its distribution</h5>
<p>Code a binary variable that takes 1 for poor health and 0 otherwise. Call this new variable <strong>Poor_health</strong>. This variable will be the explained variable of our regression model.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>census2021teaching<span class="sc">$</span>Poor_health <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  census2021teaching<span class="sc">$</span>health_binary <span class="sc">==</span> <span class="st">"Poor health"</span>, <span class="dv">1</span>,</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">ifelse</span>(census2021teaching<span class="sc">$</span>health_binary <span class="sc">==</span> <span class="st">"Good or very good health"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     0      1 
489729 107633 </code></pre>
</div>
</div>
</section>
</section>
<section id="univariate-analysis-for-age-sex-ethnicity-social-category" class="level3">
<h3 class="anchored" data-anchor-id="univariate-analysis-for-age-sex-ethnicity-social-category">4.1.2 Univariate analysis for age, sex, ethnicity, social category</h3>
<section id="frequencies-and-percentages-for-age-sex-ethnicity-social-category" class="level4">
<h4 class="anchored" data-anchor-id="frequencies-and-percentages-for-age-sex-ethnicity-social-category">Frequencies and percentages for age, sex, ethnicity, social category</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>t_a<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>resident_age_7d))</span>
<span id="cb20-2"><a href="#cb20-2"></a>t_s<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>sex))</span>
<span id="cb20-3"><a href="#cb20-3"></a>t_e<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>ethnic_group_tb_6a))</span>
<span id="cb20-4"><a href="#cb20-4"></a>t_g<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>approx_social_grade))</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="fu">cbind</span>(t_a,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_a)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           t_a     
Does not apply               0  0.0
Aged 15 years and under 110127 18.4
Aged 16 to 24 years      64094 10.7
Aged 25 to 34 years      80612 13.5
Aged 35 to 44 years      77424 13.0
Aged 45 to 54 years      79268 13.3
Aged 55 to 64 years      74757 12.5
Aged 65 years and over  111080 18.6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">cbind</span>(t_s,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_s)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  t_s   
Does not apply      0  0
Female         304863 51
Male           292499 49</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">cbind</span>(t_e,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_e)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                           t_e     
Does not apply                                               0  0.0
Asian, Asian British or Asian Welsh                      55705  9.3
Black, Black British, Black Welsh, Caribbean or African  24068  4.0
Mixed or Multiple ethnic groups                          17066  2.9
White                                                   487868 81.7
Other ethnic group                                       12655  2.1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">cbind</span>(t_g,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_g)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                             t_g
Does not apply                                                                            129807
AB Higher and intermediate managerial/administrative/professional occupations             109280
C1 Supervisory, clerical and junior managerial/administrative/professional occupations    153143
C2 Skilled manual occupations                                                              99796
DE Semi-skilled and unskilled manual occupations; unemployed and lowest grade occupations 105336
                                                                                              
Does not apply                                                                            21.7
AB Higher and intermediate managerial/administrative/professional occupations             18.3
C1 Supervisory, clerical and junior managerial/administrative/professional occupations    25.6
C2 Skilled manual occupations                                                             16.7
DE Semi-skilled and unskilled manual occupations; unemployed and lowest grade occupations 17.6</code></pre>
</div>
</div>
</section>
<section id="plot-pie-chart-age-variable" class="level4">
<h4 class="anchored" data-anchor-id="plot-pie-chart-age-variable">Plot pie chart Age variable</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>t_a.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(t_a)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">names</span>(t_a.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"pct"</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="fu">pie</span>(t_a.df<span class="sc">$</span>pct,</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(t_a.df<span class="sc">$</span>age, <span class="at">sep =</span> <span class="st">" "</span>, t_a.df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(t_a.df<span class="sc">$</span>age)), </span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="at">main =</span> <span class="st">"Distribution of respondents by age"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pie-chart-for-sex-variable" class="level4">
<h4 class="anchored" data-anchor-id="pie-chart-for-sex-variable">Pie chart for Sex variable</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>t_s.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(t_s)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">names</span>(t_s.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"pct"</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="fu">pie</span>(t_s.df<span class="sc">$</span>pct,</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(t_s.df<span class="sc">$</span>sex, <span class="at">sep =</span> <span class="st">" "</span>, t_s.df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(t_a.df<span class="sc">$</span>age)), </span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="at">main =</span> <span class="st">"Distribution of respondents by sex"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-for-ethnicity-variable" class="level4">
<h4 class="anchored" data-anchor-id="histogram-for-ethnicity-variable">Histogram for Ethnicity variable</h4>
<section id="a-recode-ethnicity-variable-with-labels" class="level5">
<h5 class="anchored" data-anchor-id="a-recode-ethnicity-variable-with-labels">a) Recode Ethnicity variable with labels</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>Ethnicity <span class="ot">&lt;-</span> census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">mutate</span>(<span class="at">Ethnicity_label =</span> <span class="fu">factor</span>(ethnic_group_tb_6a, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">8</span>), </span>
<span id="cb30-3"><a href="#cb30-3"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Asian"</span>, <span class="st">"Black"</span>, <span class="st">"Mixed"</span>, <span class="st">"White"</span>, <span class="st">"Other"</span>, <span class="st">"Does not apply"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">count</span>(Ethnicity_label, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb30-6"><a href="#cb30-6"></a>         <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="b-plot-histogram" class="level5">
<h5 class="anchored" data-anchor-id="b-plot-histogram">b) Plot histogram</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>(Ethnicity, <span class="fu">aes</span>(<span class="at">x =</span> Ethnicity_label, <span class="at">y =</span> prop)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"chocolate"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of respondents by Ethnicity"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pie-chart-for-variable-social-class" class="level4">
<h4 class="anchored" data-anchor-id="pie-chart-for-variable-social-class">Pie chart for variable social class</h4>
<section id="a-create-a-labelled-social-class-variable" class="level5">
<h5 class="anchored" data-anchor-id="a-create-a-labelled-social-class-variable">a) Create a labelled social class variable</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>Social_class <span class="ot">&lt;-</span> census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-3"><a href="#cb32-3"></a>    <span class="at">Social_class_code =</span> <span class="fu">as.integer</span>(<span class="fu">as.character</span>(approx_social_grade)),</span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">Social_class_label =</span> <span class="fu">factor</span>(</span>
<span id="cb32-5"><a href="#cb32-5"></a>      Social_class_code,</span>
<span id="cb32-6"><a href="#cb32-6"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb32-7"><a href="#cb32-7"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Higher, intermediate managers"</span>, <span class="st">"Supervisory, junior managers"</span>, </span>
<span id="cb32-8"><a href="#cb32-8"></a>                 <span class="st">"Skilled manual"</span>, <span class="st">"Semi-skilled, unskilled manual"</span>,<span class="st">"Not applicable"</span>)</span>
<span id="cb32-9"><a href="#cb32-9"></a>    )</span>
<span id="cb32-10"><a href="#cb32-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Social_class_label)) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">count</span>(Social_class_label, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="at">pct =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>),</span>
<span id="cb32-15"><a href="#cb32-15"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(Social_class_label, <span class="st">" ("</span>, pct, <span class="st">"%)"</span>)</span>
<span id="cb32-16"><a href="#cb32-16"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="b-plot-pie-chart" class="level5">
<h5 class="anchored" data-anchor-id="b-plot-pie-chart">b) Plot pie chart</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(Social_class, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> Social_class_label)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb33-5"><a href="#cb33-5"></a>                   <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-6"><a href="#cb33-6"></a>                   <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-7"><a href="#cb33-7"></a>                   <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of respondents by Social class"</span>, <span class="at">fill =</span> <span class="st">"Social class"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drop-under-16-from-the-table" class="level5">
<h5 class="anchored" data-anchor-id="drop-under-16-from-the-table">Drop under 16 from the table</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>census2021teaching <span class="ot">&lt;-</span> <span class="fu">subset</span>(census2021teaching, resident_age_7d <span class="sc">!=</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="bivariate-analysis" class="level3">
<h3 class="anchored" data-anchor-id="bivariate-analysis">4.2- Bivariate analysis</h3>
<section id="cross-tabulation-of-poor_health-by-hours-worked" class="level5">
<h5 class="anchored" data-anchor-id="cross-tabulation-of-poor_health-by-hours-worked">Cross tabulation of Poor_health by hours worked</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>tabulation <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb35-2"><a href="#cb35-2"></a>tabulation</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
        -8      1      2      3      4
  0 133254  24373  47454 149740  27898
  1  75762   4307   6960  14863   2624</code></pre>
</div>
</div>
</section>
<section id="row-percentages" class="level5">
<h5 class="anchored" data-anchor-id="row-percentages">Row percentages</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">prop.table</span>(tabulation, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
           -8         1         2         3         4
  0 34.817712  6.368380 12.399175 39.125311  7.289421
  1 72.488423  4.120900  6.659267 14.220789  2.510620</code></pre>
</div>
</div>
</section>
<section id="column-percentages" class="level5">
<h5 class="anchored" data-anchor-id="column-percentages">Column percentages</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">prop.table</span>(tabulation, <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
           -8         1         2         3         4
  0 63.753014 84.982566 87.209174 90.970395 91.402922
  1 36.246986 15.017434 12.790826  9.029605  8.597078</code></pre>
</div>
</div>
</section>
<section id="chi-square-test" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-test">Chi square test</h4>
<section id="a-creating-cross-tabulations-to-be-tested" class="level5">
<h5 class="anchored" data-anchor-id="a-creating-cross-tabulations-to-be-tested">a) Creating cross tabulations to be tested</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>tabulation.health_hours <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb41-2"><a href="#cb41-2"></a>tabulation.health_age <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>resident_age_7d)</span>
<span id="cb41-3"><a href="#cb41-3"></a>tabulation.health_sex <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>sex)</span>
<span id="cb41-4"><a href="#cb41-4"></a>tabulation.health_ethnicity <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>ethnic_group_tb_6a)</span>
<span id="cb41-5"><a href="#cb41-5"></a>tabulation.health_classes <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>approx_social_grade)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="b-chi-square-test-on-health-and-our-5-other-variables" class="level5">
<h5 class="anchored" data-anchor-id="b-chi-square-test-on-health-and-our-5-other-variables">b) chi square test on health and our 5 other variables</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">chisq.test</span>(tabulation.health_hours)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tabulation.health_hours
X-squared = 48349, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">chisq.test</span>(tabulation.health_age)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tabulation.health_age
X-squared = 47990, df = 5, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">chisq.test</span>(tabulation.health_sex)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  tabulation.health_sex
X-squared = 280.16, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">chisq.test</span>(tabulation.health_ethnicity)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tabulation.health_ethnicity
X-squared = 1454.4, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">chisq.test</span>(tabulation.health_classes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tabulation.health_classes
X-squared = 42535, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="regression-model" class="level2">
<h2 class="anchored" data-anchor-id="regression-model">5 Regression model</h2>
<section id="recode-variables-as-factors-with-labels" class="level3">
<h3 class="anchored" data-anchor-id="recode-variables-as-factors-with-labels">5.1 Recode variables as factors with labels</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>census2021teaching<span class="sc">$</span>hours_per_week_worked <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb52-2"><a href="#cb52-2"></a>  census2021teaching<span class="sc">$</span>hours_per_week_worked,</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-15"</span>, <span class="st">"16-30"</span>, <span class="st">"31-48"</span>, <span class="st">"49+"</span>, <span class="st">"Does not apply"</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>)</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a>census2021teaching<span class="sc">$</span>resident_age_7d <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb52-8"><a href="#cb52-8"></a>  census2021teaching<span class="sc">$</span>resident_age_7d,</span>
<span id="cb52-9"><a href="#cb52-9"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb52-10"><a href="#cb52-10"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-15"</span>, <span class="st">"16-24"</span>, <span class="st">"25-34"</span>, <span class="st">"35-44"</span>, <span class="st">"45-54"</span>, <span class="st">"55-64"</span>, <span class="st">"65+"</span>, <span class="st">"Not applicable"</span>)</span>
<span id="cb52-11"><a href="#cb52-11"></a>)</span>
<span id="cb52-12"><a href="#cb52-12"></a></span>
<span id="cb52-13"><a href="#cb52-13"></a>census2021teaching<span class="sc">$</span>ethnic_group_tb_6a <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb52-14"><a href="#cb52-14"></a>  census2021teaching<span class="sc">$</span>ethnic_group_tb_6a,</span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb52-16"><a href="#cb52-16"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Asian"</span>, <span class="st">"Black"</span>, <span class="st">"Mixed"</span>, <span class="st">"White"</span>, <span class="st">"Other"</span>, <span class="st">"Does not apply"</span>)</span>
<span id="cb52-17"><a href="#cb52-17"></a>)</span>
<span id="cb52-18"><a href="#cb52-18"></a></span>
<span id="cb52-19"><a href="#cb52-19"></a>census2021teaching<span class="sc">$</span>approx_social_grade <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb52-20"><a href="#cb52-20"></a>  census2021teaching<span class="sc">$</span>approx_social_grade,</span>
<span id="cb52-21"><a href="#cb52-21"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb52-22"><a href="#cb52-22"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Higher, intermediate managers"</span>,</span>
<span id="cb52-23"><a href="#cb52-23"></a>             <span class="st">"Supervisory, junior managers"</span>,</span>
<span id="cb52-24"><a href="#cb52-24"></a>             <span class="st">"Skilled manual"</span>,</span>
<span id="cb52-25"><a href="#cb52-25"></a>             <span class="st">"Semi-skilled, unskilled manual"</span>,</span>
<span id="cb52-26"><a href="#cb52-26"></a>             <span class="st">"Not applicable"</span>)</span>
<span id="cb52-27"><a href="#cb52-27"></a>)</span>
<span id="cb52-28"><a href="#cb52-28"></a></span>
<span id="cb52-29"><a href="#cb52-29"></a>census2021teaching<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb52-30"><a href="#cb52-30"></a>  census2021teaching<span class="sc">$</span>sex,</span>
<span id="cb52-31"><a href="#cb52-31"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb52-32"><a href="#cb52-32"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb52-33"><a href="#cb52-33"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pick-references-that-are-central-or-policy-relevant" class="level3">
<h3 class="anchored" data-anchor-id="pick-references-that-are-central-or-policy-relevant">5.2 Pick references that are central or policy relevant</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>census2021teaching<span class="sc">$</span>hours_per_week_worked <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked, <span class="at">ref =</span> <span class="st">"31-48"</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>census2021teaching<span class="sc">$</span>resident_age_7d         <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>resident_age_7d,         <span class="at">ref =</span> <span class="st">"45-54"</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a>census2021teaching<span class="sc">$</span>sex                  <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>sex,                  <span class="at">ref =</span> <span class="st">"Male"</span>)</span>
<span id="cb53-4"><a href="#cb53-4"></a>census2021teaching<span class="sc">$</span>ethnic_group_tb_6a            <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>ethnic_group_tb_6a,            <span class="at">ref =</span> <span class="st">"White"</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a>census2021teaching<span class="sc">$</span>approx_social_grade         <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>approx_social_grade,         <span class="at">ref =</span> <span class="st">"Higher, intermediate managers"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="fit-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="fit-logistic-regression">5.3 Fit logistic regression</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>model_health <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb54-2"><a href="#cb54-2"></a>  Poor_health <span class="sc">~</span> hours_per_week_worked <span class="sc">+</span> resident_age_7d <span class="sc">+</span> sex <span class="sc">+</span> ethnic_group_tb_6a <span class="sc">+</span> approx_social_grade,</span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="at">data =</span> census2021teaching,</span>
<span id="cb54-4"><a href="#cb54-4"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb54-5"><a href="#cb54-5"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="obtain-summary-results-of-the-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="obtain-summary-results-of-the-logistic-regression">Obtain summary results of the logistic regression</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">summary</span>(model_health)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Poor_health ~ hours_per_week_worked + resident_age_7d + 
    sex + ethnic_group_tb_6a + approx_social_grade, family = binomial(link = "logit"), 
    data = census2021teaching)

Coefficients:
                                                   Estimate Std. Error  z value
(Intercept)                                       -2.465718   0.017174 -143.571
hours_per_week_worked0-15                          0.464247   0.019453   23.865
hours_per_week_worked16-30                         0.235470   0.016068   14.654
hours_per_week_worked49+                          -0.072616   0.022560   -3.219
hours_per_week_workedDoes not apply                1.365718   0.011859  115.166
resident_age_7d16-24                              -1.709400   0.018745  -91.194
resident_age_7d25-34                              -0.925160   0.015855  -58.353
resident_age_7d35-44                              -0.523959   0.014894  -35.178
resident_age_7d55-64                               0.165097   0.013184   12.523
resident_age_7d65+                                 0.281656   0.017617   15.988
sexFemale                                          0.057929   0.007857    7.373
ethnic_group_tb_6aAsian                           -0.159309   0.014871  -10.712
ethnic_group_tb_6aBlack                           -0.300889   0.022624  -13.299
ethnic_group_tb_6aMixed                            0.050706   0.031398    1.615
ethnic_group_tb_6aOther                           -0.124834   0.028489   -4.382
approx_social_gradeSupervisory, junior managers    0.440118   0.016054   27.415
approx_social_gradeSkilled manual                  0.591386   0.017021   34.745
approx_social_gradeSemi-skilled, unskilled manual  1.262307   0.015867   79.554
approx_social_gradeNot applicable                  0.597043   0.018928   31.544
                                                  Pr(&gt;|z|)    
(Intercept)                                        &lt; 2e-16 ***
hours_per_week_worked0-15                          &lt; 2e-16 ***
hours_per_week_worked16-30                         &lt; 2e-16 ***
hours_per_week_worked49+                           0.00129 ** 
hours_per_week_workedDoes not apply                &lt; 2e-16 ***
resident_age_7d16-24                               &lt; 2e-16 ***
resident_age_7d25-34                               &lt; 2e-16 ***
resident_age_7d35-44                               &lt; 2e-16 ***
resident_age_7d55-64                               &lt; 2e-16 ***
resident_age_7d65+                                 &lt; 2e-16 ***
sexFemale                                         1.67e-13 ***
ethnic_group_tb_6aAsian                            &lt; 2e-16 ***
ethnic_group_tb_6aBlack                            &lt; 2e-16 ***
ethnic_group_tb_6aMixed                            0.10632    
ethnic_group_tb_6aOther                           1.18e-05 ***
approx_social_gradeSupervisory, junior managers    &lt; 2e-16 ***
approx_social_gradeSkilled manual                  &lt; 2e-16 ***
approx_social_gradeSemi-skilled, unskilled manual  &lt; 2e-16 ***
approx_social_gradeNot applicable                  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 506597  on 487234  degrees of freedom
Residual deviance: 424553  on 487216  degrees of freedom
AIC: 424591

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu"># R code for module activity</span></span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="fu">## 1- Install and load the main packages</span></span>
<span id="cb57-4"><a href="#cb57-4"></a></span>
<span id="cb57-5"><a href="#cb57-5"></a></span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="in">```{r packages}</span></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="do">#### Load the packages if installed; install them if not present </span></span>
<span id="cb57-8"><a href="#cb57-8"></a></span>
<span id="cb57-9"><a href="#cb57-9"></a>pkg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, </span>
<span id="cb57-10"><a href="#cb57-10"></a>         <span class="st">"ggplot2"</span>, </span>
<span id="cb57-11"><a href="#cb57-11"></a>         <span class="st">"ggrepel"</span>, </span>
<span id="cb57-12"><a href="#cb57-12"></a>         <span class="st">"patchwork"</span>, </span>
<span id="cb57-13"><a href="#cb57-13"></a>         <span class="st">"gridExtra"</span>, </span>
<span id="cb57-14"><a href="#cb57-14"></a>         <span class="st">"haven"</span>,   <span class="do">### Import Stata and SPSS datasets</span></span>
<span id="cb57-15"><a href="#cb57-15"></a>         <span class="st">"viridis"</span>  <span class="do">### colourblind friendly palette</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>)</span>
<span id="cb57-17"><a href="#cb57-17"></a></span>
<span id="cb57-18"><a href="#cb57-18"></a><span class="cf">for</span> (p <span class="cf">in</span> pkg) {</span>
<span id="cb57-19"><a href="#cb57-19"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> T)) {</span>
<span id="cb57-20"><a href="#cb57-20"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb57-21"><a href="#cb57-21"></a>    <span class="fu">library</span>(p, <span class="at">character.only =</span> T)</span>
<span id="cb57-22"><a href="#cb57-22"></a>  }</span>
<span id="cb57-23"><a href="#cb57-23"></a>}</span>
<span id="cb57-24"><a href="#cb57-24"></a><span class="in">```</span></span>
<span id="cb57-25"><a href="#cb57-25"></a></span>
<span id="cb57-26"><a href="#cb57-26"></a><span class="fu">## 2- Load the dataset and make a copy</span></span>
<span id="cb57-27"><a href="#cb57-27"></a></span>
<span id="cb57-30"><a href="#cb57-30"></a><span class="in">```{r}</span></span>
<span id="cb57-31"><a href="#cb57-31"></a>publicmicrodatateachingsample <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"data/publicmicrodatateachingsample.sav"</span>)</span>
<span id="cb57-32"><a href="#cb57-32"></a></span>
<span id="cb57-33"><a href="#cb57-33"></a>census2021teaching <span class="ot">&lt;-</span> publicmicrodatateachingsample</span>
<span id="cb57-34"><a href="#cb57-34"></a></span>
<span id="cb57-35"><a href="#cb57-35"></a><span class="in">```</span></span>
<span id="cb57-36"><a href="#cb57-36"></a></span>
<span id="cb57-37"><a href="#cb57-37"></a>Important: Remember to change the filepath to your dataset accordingly. </span>
<span id="cb57-38"><a href="#cb57-38"></a></span>
<span id="cb57-39"><a href="#cb57-39"></a>If the **read_sav** code does not work, you can use the **Import Dataset** button in the RStudio Environment Pane to load the dataset in R.</span>
<span id="cb57-40"><a href="#cb57-40"></a></span>
<span id="cb57-41"><a href="#cb57-41"></a><span class="fu">## 3- Drop unnecessary variables</span></span>
<span id="cb57-42"><a href="#cb57-42"></a></span>
<span id="cb57-45"><a href="#cb57-45"></a><span class="in">```{r}</span></span>
<span id="cb57-46"><a href="#cb57-46"></a><span class="co">#| eval: false</span></span>
<span id="cb57-47"><a href="#cb57-47"></a>census2021teaching <span class="ot">&lt;-</span> census2021teaching[,<span class="fu">c</span>(<span class="st">"health_in_general"</span>,</span>
<span id="cb57-48"><a href="#cb57-48"></a>                                            <span class="st">"hours_per_week_worked"</span>,</span>
<span id="cb57-49"><a href="#cb57-49"></a>                                            <span class="st">"resident_age_7d"</span>,<span class="st">"sex"</span>, </span>
<span id="cb57-50"><a href="#cb57-50"></a>                                            <span class="st">"ethnic_group_tb_6a"</span>,</span>
<span id="cb57-51"><a href="#cb57-51"></a>                                            <span class="st">"approx_social_grade"</span>)]</span>
<span id="cb57-52"><a href="#cb57-52"></a></span>
<span id="cb57-53"><a href="#cb57-53"></a><span class="fu">head</span>(census2021teaching)</span>
<span id="cb57-54"><a href="#cb57-54"></a><span class="fu">dim</span>(census2021teaching)</span>
<span id="cb57-55"><a href="#cb57-55"></a><span class="in">```</span></span>
<span id="cb57-56"><a href="#cb57-56"></a></span>
<span id="cb57-57"><a href="#cb57-57"></a>::: {.callout-note collapse="true"}</span>
<span id="cb57-58"><a href="#cb57-58"></a></span>
<span id="cb57-59"><a href="#cb57-59"></a><span class="fu">## Click to view results</span></span>
<span id="cb57-60"><a href="#cb57-60"></a></span>
<span id="cb57-63"><a href="#cb57-63"></a><span class="in">```{r}</span></span>
<span id="cb57-64"><a href="#cb57-64"></a><span class="co">#| echo: false</span></span>
<span id="cb57-65"><a href="#cb57-65"></a>census2021teaching <span class="ot">&lt;-</span> census2021teaching[,<span class="fu">c</span>(<span class="st">"health_in_general"</span>,</span>
<span id="cb57-66"><a href="#cb57-66"></a>                                            <span class="st">"hours_per_week_worked"</span>,</span>
<span id="cb57-67"><a href="#cb57-67"></a>                                            <span class="st">"resident_age_7d"</span>,<span class="st">"sex"</span>, </span>
<span id="cb57-68"><a href="#cb57-68"></a>                                            <span class="st">"ethnic_group_tb_6a"</span>,</span>
<span id="cb57-69"><a href="#cb57-69"></a>                                            <span class="st">"approx_social_grade"</span>)]</span>
<span id="cb57-70"><a href="#cb57-70"></a></span>
<span id="cb57-71"><a href="#cb57-71"></a><span class="fu">head</span>(census2021teaching)</span>
<span id="cb57-72"><a href="#cb57-72"></a><span class="fu">dim</span>(census2021teaching)</span>
<span id="cb57-73"><a href="#cb57-73"></a><span class="in">```</span></span>
<span id="cb57-74"><a href="#cb57-74"></a></span>
<span id="cb57-75"><a href="#cb57-75"></a>:::</span>
<span id="cb57-76"><a href="#cb57-76"></a></span>
<span id="cb57-77"><a href="#cb57-77"></a><span class="fu">## 4- Exploratory analysis</span></span>
<span id="cb57-78"><a href="#cb57-78"></a></span>
<span id="cb57-79"><a href="#cb57-79"></a><span class="fu">### 4.1- Univariate analysis </span></span>
<span id="cb57-80"><a href="#cb57-80"></a></span>
<span id="cb57-81"><a href="#cb57-81"></a><span class="fu">#### 4.1.1 Univariate analysis for health in general and hours worked</span></span>
<span id="cb57-82"><a href="#cb57-82"></a></span>
<span id="cb57-83"><a href="#cb57-83"></a><span class="fu">##### Frequencies for health in general and hours worked</span></span>
<span id="cb57-84"><a href="#cb57-84"></a></span>
<span id="cb57-87"><a href="#cb57-87"></a><span class="in">```{r}</span></span>
<span id="cb57-88"><a href="#cb57-88"></a><span class="co">#| eval: false</span></span>
<span id="cb57-89"><a href="#cb57-89"></a></span>
<span id="cb57-90"><a href="#cb57-90"></a><span class="do">### Raw values</span></span>
<span id="cb57-91"><a href="#cb57-91"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb57-92"><a href="#cb57-92"></a></span>
<span id="cb57-93"><a href="#cb57-93"></a><span class="do">### Labelled  values</span></span>
<span id="cb57-94"><a href="#cb57-94"></a><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked))</span>
<span id="cb57-95"><a href="#cb57-95"></a></span>
<span id="cb57-96"><a href="#cb57-96"></a><span class="in">```</span></span>
<span id="cb57-97"><a href="#cb57-97"></a></span>
<span id="cb57-98"><a href="#cb57-98"></a>::: {.callout-note collapse="true"}</span>
<span id="cb57-99"><a href="#cb57-99"></a></span>
<span id="cb57-100"><a href="#cb57-100"></a><span class="fu">## Click to view results</span></span>
<span id="cb57-101"><a href="#cb57-101"></a></span>
<span id="cb57-104"><a href="#cb57-104"></a><span class="in">```{r}</span></span>
<span id="cb57-105"><a href="#cb57-105"></a><span class="co">#| echo: false</span></span>
<span id="cb57-106"><a href="#cb57-106"></a></span>
<span id="cb57-107"><a href="#cb57-107"></a><span class="do">### Raw values</span></span>
<span id="cb57-108"><a href="#cb57-108"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb57-109"><a href="#cb57-109"></a></span>
<span id="cb57-110"><a href="#cb57-110"></a><span class="do">### Labelled  values</span></span>
<span id="cb57-111"><a href="#cb57-111"></a><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked))</span>
<span id="cb57-112"><a href="#cb57-112"></a><span class="in">```</span></span>
<span id="cb57-113"><a href="#cb57-113"></a></span>
<span id="cb57-114"><a href="#cb57-114"></a>:::</span>
<span id="cb57-115"><a href="#cb57-115"></a></span>
<span id="cb57-116"><a href="#cb57-116"></a><span class="fu">##### Distribution of self-rated health and hours worked</span></span>
<span id="cb57-117"><a href="#cb57-117"></a></span>
<span id="cb57-118"><a href="#cb57-118"></a></span>
<span id="cb57-121"><a href="#cb57-121"></a><span class="in">```{r}</span></span>
<span id="cb57-122"><a href="#cb57-122"></a><span class="co">#| eval: false</span></span>
<span id="cb57-123"><a href="#cb57-123"></a></span>
<span id="cb57-124"><a href="#cb57-124"></a><span class="fu">round</span>(</span>
<span id="cb57-125"><a href="#cb57-125"></a>      <span class="fu">prop.table</span>(</span>
<span id="cb57-126"><a href="#cb57-126"></a>        <span class="fu">table</span>(</span>
<span id="cb57-127"><a href="#cb57-127"></a>          <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general</span>
<span id="cb57-128"><a href="#cb57-128"></a>                )</span>
<span id="cb57-129"><a href="#cb57-129"></a>      )</span>
<span id="cb57-130"><a href="#cb57-130"></a>      ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb57-131"><a href="#cb57-131"></a>      <span class="dv">1</span>) </span>
<span id="cb57-132"><a href="#cb57-132"></a></span>
<span id="cb57-133"><a href="#cb57-133"></a><span class="fu">round</span>(</span>
<span id="cb57-134"><a href="#cb57-134"></a>  <span class="fu">prop.table</span>(</span>
<span id="cb57-135"><a href="#cb57-135"></a>    <span class="fu">table</span>(</span>
<span id="cb57-136"><a href="#cb57-136"></a>      <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb57-137"><a href="#cb57-137"></a>      )</span>
<span id="cb57-138"><a href="#cb57-138"></a>    ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb57-139"><a href="#cb57-139"></a>  <span class="dv">1</span>)</span>
<span id="cb57-140"><a href="#cb57-140"></a></span>
<span id="cb57-141"><a href="#cb57-141"></a><span class="in">```</span></span>
<span id="cb57-142"><a href="#cb57-142"></a>::: {.callout-note collapse="true"}</span>
<span id="cb57-143"><a href="#cb57-143"></a></span>
<span id="cb57-144"><a href="#cb57-144"></a><span class="fu">## Click to view results</span></span>
<span id="cb57-145"><a href="#cb57-145"></a></span>
<span id="cb57-148"><a href="#cb57-148"></a><span class="in">```{r}</span></span>
<span id="cb57-149"><a href="#cb57-149"></a><span class="co">#| echo: false</span></span>
<span id="cb57-150"><a href="#cb57-150"></a></span>
<span id="cb57-151"><a href="#cb57-151"></a><span class="fu">round</span>(</span>
<span id="cb57-152"><a href="#cb57-152"></a>      <span class="fu">prop.table</span>(</span>
<span id="cb57-153"><a href="#cb57-153"></a>        <span class="fu">table</span>(</span>
<span id="cb57-154"><a href="#cb57-154"></a>          <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general</span>
<span id="cb57-155"><a href="#cb57-155"></a>                )</span>
<span id="cb57-156"><a href="#cb57-156"></a>      )</span>
<span id="cb57-157"><a href="#cb57-157"></a>      ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb57-158"><a href="#cb57-158"></a>      <span class="dv">1</span>) </span>
<span id="cb57-159"><a href="#cb57-159"></a></span>
<span id="cb57-160"><a href="#cb57-160"></a><span class="fu">round</span>(</span>
<span id="cb57-161"><a href="#cb57-161"></a>  <span class="fu">prop.table</span>(</span>
<span id="cb57-162"><a href="#cb57-162"></a>    <span class="fu">table</span>(</span>
<span id="cb57-163"><a href="#cb57-163"></a>      <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb57-164"><a href="#cb57-164"></a>      )</span>
<span id="cb57-165"><a href="#cb57-165"></a>    ) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb57-166"><a href="#cb57-166"></a>  <span class="dv">1</span>)</span>
<span id="cb57-167"><a href="#cb57-167"></a></span>
<span id="cb57-168"><a href="#cb57-168"></a><span class="in">```</span></span>
<span id="cb57-169"><a href="#cb57-169"></a></span>
<span id="cb57-170"><a href="#cb57-170"></a>:::</span>
<span id="cb57-171"><a href="#cb57-171"></a></span>
<span id="cb57-172"><a href="#cb57-172"></a><span class="co">&lt;!-- You can also calculate these frequencies and percentages with appropriate labels. --&gt;</span></span>
<span id="cb57-173"><a href="#cb57-173"></a></span>
<span id="cb57-174"><a href="#cb57-174"></a><span class="fu">##### Frequencies and percentages with labels for health in general and hours worked</span></span>
<span id="cb57-175"><a href="#cb57-175"></a></span>
<span id="cb57-176"><a href="#cb57-176"></a></span>
<span id="cb57-177"><a href="#cb57-177"></a>You can also generate pie charts for better visualization</span>
<span id="cb57-178"><a href="#cb57-178"></a></span>
<span id="cb57-179"><a href="#cb57-179"></a><span class="fu">### a) Pie chart for self-rated general health</span></span>
<span id="cb57-180"><a href="#cb57-180"></a></span>
<span id="cb57-181"><a href="#cb57-181"></a></span>
<span id="cb57-182"><a href="#cb57-182"></a></span>
<span id="cb57-183"><a href="#cb57-183"></a><span class="in">```{r p1}</span></span>
<span id="cb57-184"><a href="#cb57-184"></a><span class="co">#| eval: false</span></span>
<span id="cb57-185"><a href="#cb57-185"></a></span>
<span id="cb57-186"><a href="#cb57-186"></a>h1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span></span>
<span id="cb57-187"><a href="#cb57-187"></a>            <span class="fu">prop.table</span>(</span>
<span id="cb57-188"><a href="#cb57-188"></a>              <span class="fu">table</span>(</span>
<span id="cb57-189"><a href="#cb57-189"></a>                <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb57-190"><a href="#cb57-190"></a>                )</span>
<span id="cb57-191"><a href="#cb57-191"></a>              ),<span class="dv">1</span></span>
<span id="cb57-192"><a href="#cb57-192"></a>          )</span>
<span id="cb57-193"><a href="#cb57-193"></a></span>
<span id="cb57-194"><a href="#cb57-194"></a>h1_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(h1)</span>
<span id="cb57-195"><a href="#cb57-195"></a></span>
<span id="cb57-196"><a href="#cb57-196"></a><span class="fu">names</span>(h1_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"srh"</span>, <span class="st">"pct"</span>)</span>
<span id="cb57-197"><a href="#cb57-197"></a></span>
<span id="cb57-198"><a href="#cb57-198"></a><span class="fu">pie</span>(h1_df<span class="sc">$</span>pct,</span>
<span id="cb57-199"><a href="#cb57-199"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(h1_df<span class="sc">$</span>srh, <span class="at">sep =</span> <span class="st">" "</span>, h1_df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb57-200"><a href="#cb57-200"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb57-201"><a href="#cb57-201"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb57-202"><a href="#cb57-202"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(h1_df<span class="sc">$</span>srh)), </span>
<span id="cb57-203"><a href="#cb57-203"></a>    <span class="at">main =</span> <span class="st">"Self-rated general health"</span>)</span>
<span id="cb57-204"><a href="#cb57-204"></a></span>
<span id="cb57-205"><a href="#cb57-205"></a><span class="in">```</span></span>
<span id="cb57-206"><a href="#cb57-206"></a>::: {.callout-note collapse="true"}</span>
<span id="cb57-207"><a href="#cb57-207"></a></span>
<span id="cb57-208"><a href="#cb57-208"></a><span class="fu">## Click to view results</span></span>
<span id="cb57-209"><a href="#cb57-209"></a><span class="in">```{r p1.2}</span></span>
<span id="cb57-210"><a href="#cb57-210"></a><span class="co">#| echo: false</span></span>
<span id="cb57-211"><a href="#cb57-211"></a></span>
<span id="cb57-212"><a href="#cb57-212"></a>h1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span></span>
<span id="cb57-213"><a href="#cb57-213"></a>            <span class="fu">prop.table</span>(</span>
<span id="cb57-214"><a href="#cb57-214"></a>              <span class="fu">table</span>(</span>
<span id="cb57-215"><a href="#cb57-215"></a>                <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>health_in_general)</span>
<span id="cb57-216"><a href="#cb57-216"></a>                )</span>
<span id="cb57-217"><a href="#cb57-217"></a>              ),<span class="dv">1</span></span>
<span id="cb57-218"><a href="#cb57-218"></a>          )</span>
<span id="cb57-219"><a href="#cb57-219"></a></span>
<span id="cb57-220"><a href="#cb57-220"></a>h1_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(h1)</span>
<span id="cb57-221"><a href="#cb57-221"></a></span>
<span id="cb57-222"><a href="#cb57-222"></a><span class="fu">names</span>(h1_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"srh"</span>, <span class="st">"pct"</span>)</span>
<span id="cb57-223"><a href="#cb57-223"></a></span>
<span id="cb57-224"><a href="#cb57-224"></a><span class="fu">pie</span>(h1_df<span class="sc">$</span>pct,</span>
<span id="cb57-225"><a href="#cb57-225"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(h1_df<span class="sc">$</span>srh, <span class="at">sep =</span> <span class="st">" "</span>, h1_df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb57-226"><a href="#cb57-226"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb57-227"><a href="#cb57-227"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb57-228"><a href="#cb57-228"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(h1_df<span class="sc">$</span>srh)), </span>
<span id="cb57-229"><a href="#cb57-229"></a>    <span class="at">main =</span> <span class="st">"Self-rated general health"</span>)</span>
<span id="cb57-230"><a href="#cb57-230"></a></span>
<span id="cb57-231"><a href="#cb57-231"></a><span class="in">```</span></span>
<span id="cb57-232"><a href="#cb57-232"></a></span>
<span id="cb57-233"><a href="#cb57-233"></a>:::</span>
<span id="cb57-234"><a href="#cb57-234"></a></span>
<span id="cb57-235"><a href="#cb57-235"></a><span class="fu">### b) Pie chart for Hours worked</span></span>
<span id="cb57-236"><a href="#cb57-236"></a></span>
<span id="cb57-237"><a href="#cb57-237"></a><span class="fu">##### b.1) Create a labelled hours worked variable</span></span>
<span id="cb57-238"><a href="#cb57-238"></a></span>
<span id="cb57-239"><a href="#cb57-239"></a></span>
<span id="cb57-240"><a href="#cb57-240"></a><span class="in">```{r p2}</span></span>
<span id="cb57-241"><a href="#cb57-241"></a><span class="co">#| code-fold: true</span></span>
<span id="cb57-242"><a href="#cb57-242"></a><span class="co">#| code-summary: "View output"</span></span>
<span id="cb57-243"><a href="#cb57-243"></a></span>
<span id="cb57-244"><a href="#cb57-244"></a>h2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span></span>
<span id="cb57-245"><a href="#cb57-245"></a>            <span class="fu">prop.table</span>(</span>
<span id="cb57-246"><a href="#cb57-246"></a>              <span class="fu">table</span>(</span>
<span id="cb57-247"><a href="#cb57-247"></a>                <span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked))</span>
<span id="cb57-248"><a href="#cb57-248"></a>              ),<span class="dv">1</span></span>
<span id="cb57-249"><a href="#cb57-249"></a>          )</span>
<span id="cb57-250"><a href="#cb57-250"></a></span>
<span id="cb57-251"><a href="#cb57-251"></a>h2_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(h2)</span>
<span id="cb57-252"><a href="#cb57-252"></a></span>
<span id="cb57-253"><a href="#cb57-253"></a><span class="fu">names</span>(h2_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hpw"</span>, <span class="st">"pct"</span>)</span>
<span id="cb57-254"><a href="#cb57-254"></a></span>
<span id="cb57-255"><a href="#cb57-255"></a>p2<span class="ot">&lt;-</span><span class="fu">pie</span>(h2_df<span class="sc">$</span>pct,</span>
<span id="cb57-256"><a href="#cb57-256"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(h2_df<span class="sc">$</span>hpw, <span class="at">sep =</span> <span class="st">" "</span>, h2_df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb57-257"><a href="#cb57-257"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb57-258"><a href="#cb57-258"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb57-259"><a href="#cb57-259"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(h2_df<span class="sc">$</span>hpw)), </span>
<span id="cb57-260"><a href="#cb57-260"></a>    <span class="at">main =</span> <span class="st">"Hours worked per week"</span>)</span>
<span id="cb57-261"><a href="#cb57-261"></a></span>
<span id="cb57-262"><a href="#cb57-262"></a><span class="in">```</span></span>
<span id="cb57-263"><a href="#cb57-263"></a></span>
<span id="cb57-264"><a href="#cb57-264"></a></span>
<span id="cb57-265"><a href="#cb57-265"></a><span class="fu">### 4.1.1.1 Transformation of variable Health in general</span></span>
<span id="cb57-266"><a href="#cb57-266"></a></span>
<span id="cb57-267"><a href="#cb57-267"></a>Create a new variable called **health_binary** by regrouping health in general in two broader categories: **Good or very good health** and **Poor health**</span>
<span id="cb57-268"><a href="#cb57-268"></a></span>
<span id="cb57-269"><a href="#cb57-269"></a></span>
<span id="cb57-272"><a href="#cb57-272"></a><span class="in">```{r}</span></span>
<span id="cb57-273"><a href="#cb57-273"></a>census2021teaching<span class="sc">$</span>health_binary <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb57-274"><a href="#cb57-274"></a>  census2021teaching<span class="sc">$</span>health_in_general <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="st">"Good or very good health"</span>,</span>
<span id="cb57-275"><a href="#cb57-275"></a>  <span class="fu">ifelse</span>(census2021teaching<span class="sc">$</span>health_in_general <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="st">"Poor health"</span>, <span class="cn">NA</span>)</span>
<span id="cb57-276"><a href="#cb57-276"></a>)</span>
<span id="cb57-277"><a href="#cb57-277"></a></span>
<span id="cb57-278"><a href="#cb57-278"></a><span class="in">```</span></span>
<span id="cb57-279"><a href="#cb57-279"></a></span>
<span id="cb57-280"><a href="#cb57-280"></a><span class="fu">##### Drop rows where health_in_general = -8 (Does not apply)</span></span>
<span id="cb57-281"><a href="#cb57-281"></a></span>
<span id="cb57-284"><a href="#cb57-284"></a><span class="in">```{r}</span></span>
<span id="cb57-285"><a href="#cb57-285"></a>census2021teaching <span class="ot">&lt;-</span>census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb57-286"><a href="#cb57-286"></a>                      <span class="fu">filter</span>(health_in_general <span class="sc">!=</span> <span class="sc">-</span><span class="dv">8</span>)</span>
<span id="cb57-287"><a href="#cb57-287"></a></span>
<span id="cb57-288"><a href="#cb57-288"></a><span class="in">```</span></span>
<span id="cb57-289"><a href="#cb57-289"></a></span>
<span id="cb57-290"><a href="#cb57-290"></a><span class="fu">##### Check the new variable's distribution</span></span>
<span id="cb57-291"><a href="#cb57-291"></a></span>
<span id="cb57-294"><a href="#cb57-294"></a><span class="in">```{r}</span></span>
<span id="cb57-295"><a href="#cb57-295"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>health_binary)</span>
<span id="cb57-296"><a href="#cb57-296"></a></span>
<span id="cb57-297"><a href="#cb57-297"></a><span class="in">```</span></span>
<span id="cb57-298"><a href="#cb57-298"></a></span>
<span id="cb57-299"><a href="#cb57-299"></a><span class="fu">#####  Create variable **Poor_health** and check its distribution</span></span>
<span id="cb57-300"><a href="#cb57-300"></a></span>
<span id="cb57-301"><a href="#cb57-301"></a>Code a binary variable that takes 1 for poor health and 0 otherwise. Call this new variable **Poor_health**. This variable will be the explained variable of our regression model.</span>
<span id="cb57-302"><a href="#cb57-302"></a></span>
<span id="cb57-305"><a href="#cb57-305"></a><span class="in">```{r}</span></span>
<span id="cb57-306"><a href="#cb57-306"></a>census2021teaching<span class="sc">$</span>Poor_health <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb57-307"><a href="#cb57-307"></a>  census2021teaching<span class="sc">$</span>health_binary <span class="sc">==</span> <span class="st">"Poor health"</span>, <span class="dv">1</span>,</span>
<span id="cb57-308"><a href="#cb57-308"></a>  <span class="fu">ifelse</span>(census2021teaching<span class="sc">$</span>health_binary <span class="sc">==</span> <span class="st">"Good or very good health"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb57-309"><a href="#cb57-309"></a>)</span>
<span id="cb57-310"><a href="#cb57-310"></a></span>
<span id="cb57-311"><a href="#cb57-311"></a><span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health)</span>
<span id="cb57-312"><a href="#cb57-312"></a></span>
<span id="cb57-313"><a href="#cb57-313"></a><span class="in">```</span></span>
<span id="cb57-314"><a href="#cb57-314"></a></span>
<span id="cb57-315"><a href="#cb57-315"></a><span class="fu">### 4.1.2 Univariate analysis for age, sex, ethnicity, social category </span></span>
<span id="cb57-316"><a href="#cb57-316"></a></span>
<span id="cb57-317"><a href="#cb57-317"></a><span class="fu">#### Frequencies and percentages for age, sex, ethnicity, social category </span></span>
<span id="cb57-318"><a href="#cb57-318"></a></span>
<span id="cb57-321"><a href="#cb57-321"></a><span class="in">```{r}</span></span>
<span id="cb57-322"><a href="#cb57-322"></a>t_a<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>resident_age_7d))</span>
<span id="cb57-323"><a href="#cb57-323"></a>t_s<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>sex))</span>
<span id="cb57-324"><a href="#cb57-324"></a>t_e<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>ethnic_group_tb_6a))</span>
<span id="cb57-325"><a href="#cb57-325"></a>t_g<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="fu">as_factor</span>(census2021teaching<span class="sc">$</span>approx_social_grade))</span>
<span id="cb57-326"><a href="#cb57-326"></a></span>
<span id="cb57-327"><a href="#cb57-327"></a><span class="fu">cbind</span>(t_a,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_a)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-328"><a href="#cb57-328"></a><span class="fu">cbind</span>(t_s,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_s)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-329"><a href="#cb57-329"></a><span class="fu">cbind</span>(t_e,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_e)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-330"><a href="#cb57-330"></a><span class="fu">cbind</span>(t_g,<span class="fu">round</span>(<span class="fu">prop.table</span>(t_g)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-331"><a href="#cb57-331"></a></span>
<span id="cb57-332"><a href="#cb57-332"></a><span class="in">```</span></span>
<span id="cb57-333"><a href="#cb57-333"></a></span>
<span id="cb57-334"><a href="#cb57-334"></a><span class="fu">#### Plot pie chart Age variable</span></span>
<span id="cb57-335"><a href="#cb57-335"></a></span>
<span id="cb57-338"><a href="#cb57-338"></a><span class="in">```{r}</span></span>
<span id="cb57-339"><a href="#cb57-339"></a>t_a.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(t_a)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-340"><a href="#cb57-340"></a><span class="fu">names</span>(t_a.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"pct"</span>)</span>
<span id="cb57-341"><a href="#cb57-341"></a></span>
<span id="cb57-342"><a href="#cb57-342"></a><span class="fu">pie</span>(t_a.df<span class="sc">$</span>pct,</span>
<span id="cb57-343"><a href="#cb57-343"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(t_a.df<span class="sc">$</span>age, <span class="at">sep =</span> <span class="st">" "</span>, t_a.df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb57-344"><a href="#cb57-344"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb57-345"><a href="#cb57-345"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb57-346"><a href="#cb57-346"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(t_a.df<span class="sc">$</span>age)), </span>
<span id="cb57-347"><a href="#cb57-347"></a>    <span class="at">main =</span> <span class="st">"Distribution of respondents by age"</span>)</span>
<span id="cb57-348"><a href="#cb57-348"></a></span>
<span id="cb57-349"><a href="#cb57-349"></a></span>
<span id="cb57-350"><a href="#cb57-350"></a><span class="in">```</span></span>
<span id="cb57-351"><a href="#cb57-351"></a></span>
<span id="cb57-352"><a href="#cb57-352"></a><span class="fu">#### Pie chart for Sex variable</span></span>
<span id="cb57-353"><a href="#cb57-353"></a></span>
<span id="cb57-354"><a href="#cb57-354"></a></span>
<span id="cb57-357"><a href="#cb57-357"></a><span class="in">```{r}</span></span>
<span id="cb57-358"><a href="#cb57-358"></a>t_s.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(t_s)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>))</span>
<span id="cb57-359"><a href="#cb57-359"></a><span class="fu">names</span>(t_s.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"pct"</span>)</span>
<span id="cb57-360"><a href="#cb57-360"></a></span>
<span id="cb57-361"><a href="#cb57-361"></a><span class="fu">pie</span>(t_s.df<span class="sc">$</span>pct,</span>
<span id="cb57-362"><a href="#cb57-362"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(t_s.df<span class="sc">$</span>sex, <span class="at">sep =</span> <span class="st">" "</span>, t_s.df<span class="sc">$</span>pct, <span class="st">"%"</span>),</span>
<span id="cb57-363"><a href="#cb57-363"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb57-364"><a href="#cb57-364"></a>    <span class="at">radius=</span><span class="fl">0.9</span>,</span>
<span id="cb57-365"><a href="#cb57-365"></a>    <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(t_a.df<span class="sc">$</span>age)), </span>
<span id="cb57-366"><a href="#cb57-366"></a>    <span class="at">main =</span> <span class="st">"Distribution of respondents by sex"</span>)</span>
<span id="cb57-367"><a href="#cb57-367"></a></span>
<span id="cb57-368"><a href="#cb57-368"></a></span>
<span id="cb57-369"><a href="#cb57-369"></a><span class="in">```</span></span>
<span id="cb57-370"><a href="#cb57-370"></a></span>
<span id="cb57-371"><a href="#cb57-371"></a><span class="fu">#### Histogram for Ethnicity variable</span></span>
<span id="cb57-372"><a href="#cb57-372"></a></span>
<span id="cb57-373"><a href="#cb57-373"></a><span class="fu">##### a) Recode Ethnicity variable with labels</span></span>
<span id="cb57-374"><a href="#cb57-374"></a></span>
<span id="cb57-377"><a href="#cb57-377"></a><span class="in">```{r}</span></span>
<span id="cb57-378"><a href="#cb57-378"></a>Ethnicity <span class="ot">&lt;-</span> census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb57-379"><a href="#cb57-379"></a>  <span class="fu">mutate</span>(<span class="at">Ethnicity_label =</span> <span class="fu">factor</span>(ethnic_group_tb_6a, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">8</span>), </span>
<span id="cb57-380"><a href="#cb57-380"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Asian"</span>, <span class="st">"Black"</span>, <span class="st">"Mixed"</span>, <span class="st">"White"</span>, <span class="st">"Other"</span>, <span class="st">"Does not apply"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb57-381"><a href="#cb57-381"></a>  <span class="fu">count</span>(Ethnicity_label, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-382"><a href="#cb57-382"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb57-383"><a href="#cb57-383"></a>         <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>))</span>
<span id="cb57-384"><a href="#cb57-384"></a></span>
<span id="cb57-385"><a href="#cb57-385"></a><span class="in">```</span></span>
<span id="cb57-386"><a href="#cb57-386"></a></span>
<span id="cb57-387"><a href="#cb57-387"></a><span class="fu">##### b) Plot histogram</span></span>
<span id="cb57-388"><a href="#cb57-388"></a></span>
<span id="cb57-391"><a href="#cb57-391"></a><span class="in">```{r}</span></span>
<span id="cb57-392"><a href="#cb57-392"></a><span class="fu">ggplot</span>(Ethnicity, <span class="fu">aes</span>(<span class="at">x =</span> Ethnicity_label, <span class="at">y =</span> prop)) <span class="sc">+</span></span>
<span id="cb57-393"><a href="#cb57-393"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"chocolate"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb57-394"><a href="#cb57-394"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-395"><a href="#cb57-395"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb57-396"><a href="#cb57-396"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of respondents by Ethnicity"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb57-397"><a href="#cb57-397"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb57-398"><a href="#cb57-398"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb57-399"><a href="#cb57-399"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb57-400"><a href="#cb57-400"></a></span>
<span id="cb57-401"><a href="#cb57-401"></a><span class="in">```</span></span>
<span id="cb57-402"><a href="#cb57-402"></a></span>
<span id="cb57-403"><a href="#cb57-403"></a><span class="fu">#### Pie chart for variable social class</span></span>
<span id="cb57-404"><a href="#cb57-404"></a></span>
<span id="cb57-405"><a href="#cb57-405"></a><span class="fu">##### a) Create a labelled social class variable</span></span>
<span id="cb57-406"><a href="#cb57-406"></a></span>
<span id="cb57-409"><a href="#cb57-409"></a><span class="in">```{r}</span></span>
<span id="cb57-410"><a href="#cb57-410"></a>Social_class <span class="ot">&lt;-</span> census2021teaching <span class="sc">%&gt;%</span></span>
<span id="cb57-411"><a href="#cb57-411"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-412"><a href="#cb57-412"></a>    <span class="at">Social_class_code =</span> <span class="fu">as.integer</span>(<span class="fu">as.character</span>(approx_social_grade)),</span>
<span id="cb57-413"><a href="#cb57-413"></a>    <span class="at">Social_class_label =</span> <span class="fu">factor</span>(</span>
<span id="cb57-414"><a href="#cb57-414"></a>      Social_class_code,</span>
<span id="cb57-415"><a href="#cb57-415"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb57-416"><a href="#cb57-416"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Higher, intermediate managers"</span>, <span class="st">"Supervisory, junior managers"</span>, </span>
<span id="cb57-417"><a href="#cb57-417"></a>                 <span class="st">"Skilled manual"</span>, <span class="st">"Semi-skilled, unskilled manual"</span>,<span class="st">"Not applicable"</span>)</span>
<span id="cb57-418"><a href="#cb57-418"></a>    )</span>
<span id="cb57-419"><a href="#cb57-419"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-420"><a href="#cb57-420"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Social_class_label)) <span class="sc">%&gt;%</span></span>
<span id="cb57-421"><a href="#cb57-421"></a>  <span class="fu">count</span>(Social_class_label, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-422"><a href="#cb57-422"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-423"><a href="#cb57-423"></a>    <span class="at">pct =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>),</span>
<span id="cb57-424"><a href="#cb57-424"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(Social_class_label, <span class="st">" ("</span>, pct, <span class="st">"%)"</span>)</span>
<span id="cb57-425"><a href="#cb57-425"></a>  )</span>
<span id="cb57-426"><a href="#cb57-426"></a></span>
<span id="cb57-427"><a href="#cb57-427"></a><span class="in">```</span></span>
<span id="cb57-428"><a href="#cb57-428"></a></span>
<span id="cb57-429"><a href="#cb57-429"></a><span class="fu">##### b) Plot pie chart</span></span>
<span id="cb57-430"><a href="#cb57-430"></a></span>
<span id="cb57-433"><a href="#cb57-433"></a><span class="in">```{r}</span></span>
<span id="cb57-434"><a href="#cb57-434"></a><span class="fu">ggplot</span>(Social_class, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> Social_class_label)) <span class="sc">+</span></span>
<span id="cb57-435"><a href="#cb57-435"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb57-436"><a href="#cb57-436"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb57-437"><a href="#cb57-437"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb57-438"><a href="#cb57-438"></a>                   <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb57-439"><a href="#cb57-439"></a>                   <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb57-440"><a href="#cb57-440"></a>                   <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-441"><a href="#cb57-441"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of respondents by Social class"</span>, <span class="at">fill =</span> <span class="st">"Social class"</span>) <span class="sc">+</span></span>
<span id="cb57-442"><a href="#cb57-442"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb57-443"><a href="#cb57-443"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb57-444"><a href="#cb57-444"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb57-445"><a href="#cb57-445"></a></span>
<span id="cb57-446"><a href="#cb57-446"></a><span class="in">```</span></span>
<span id="cb57-447"><a href="#cb57-447"></a></span>
<span id="cb57-448"><a href="#cb57-448"></a><span class="fu">##### Drop under 16 from the table</span></span>
<span id="cb57-449"><a href="#cb57-449"></a></span>
<span id="cb57-452"><a href="#cb57-452"></a><span class="in">```{r}</span></span>
<span id="cb57-453"><a href="#cb57-453"></a>census2021teaching <span class="ot">&lt;-</span> <span class="fu">subset</span>(census2021teaching, resident_age_7d <span class="sc">!=</span> <span class="dv">1</span>)</span>
<span id="cb57-454"><a href="#cb57-454"></a></span>
<span id="cb57-455"><a href="#cb57-455"></a><span class="in">```</span></span>
<span id="cb57-456"><a href="#cb57-456"></a></span>
<span id="cb57-457"><a href="#cb57-457"></a><span class="fu">### 4.2- Bivariate analysis </span></span>
<span id="cb57-458"><a href="#cb57-458"></a></span>
<span id="cb57-459"><a href="#cb57-459"></a><span class="fu">##### Cross tabulation of Poor_health by hours worked</span></span>
<span id="cb57-460"><a href="#cb57-460"></a></span>
<span id="cb57-463"><a href="#cb57-463"></a><span class="in">```{r}</span></span>
<span id="cb57-464"><a href="#cb57-464"></a>tabulation <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb57-465"><a href="#cb57-465"></a>tabulation</span>
<span id="cb57-466"><a href="#cb57-466"></a></span>
<span id="cb57-467"><a href="#cb57-467"></a><span class="in">```</span></span>
<span id="cb57-468"><a href="#cb57-468"></a></span>
<span id="cb57-469"><a href="#cb57-469"></a><span class="fu">##### Row percentages</span></span>
<span id="cb57-470"><a href="#cb57-470"></a></span>
<span id="cb57-473"><a href="#cb57-473"></a><span class="in">```{r}</span></span>
<span id="cb57-474"><a href="#cb57-474"></a><span class="fu">prop.table</span>(tabulation, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb57-475"><a href="#cb57-475"></a></span>
<span id="cb57-476"><a href="#cb57-476"></a><span class="in">```</span></span>
<span id="cb57-477"><a href="#cb57-477"></a></span>
<span id="cb57-478"><a href="#cb57-478"></a><span class="fu">##### Column percentages</span></span>
<span id="cb57-479"><a href="#cb57-479"></a></span>
<span id="cb57-482"><a href="#cb57-482"></a><span class="in">```{r}</span></span>
<span id="cb57-483"><a href="#cb57-483"></a><span class="fu">prop.table</span>(tabulation, <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb57-484"><a href="#cb57-484"></a></span>
<span id="cb57-485"><a href="#cb57-485"></a><span class="in">```</span></span>
<span id="cb57-486"><a href="#cb57-486"></a><span class="fu">#### Chi square test</span></span>
<span id="cb57-487"><a href="#cb57-487"></a></span>
<span id="cb57-488"><a href="#cb57-488"></a><span class="fu">##### a) Creating cross tabulations to be tested</span></span>
<span id="cb57-489"><a href="#cb57-489"></a></span>
<span id="cb57-492"><a href="#cb57-492"></a><span class="in">```{r}</span></span>
<span id="cb57-493"><a href="#cb57-493"></a>tabulation.health_hours <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>hours_per_week_worked)</span>
<span id="cb57-494"><a href="#cb57-494"></a>tabulation.health_age <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>resident_age_7d)</span>
<span id="cb57-495"><a href="#cb57-495"></a>tabulation.health_sex <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>sex)</span>
<span id="cb57-496"><a href="#cb57-496"></a>tabulation.health_ethnicity <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>ethnic_group_tb_6a)</span>
<span id="cb57-497"><a href="#cb57-497"></a>tabulation.health_classes <span class="ot">&lt;-</span> <span class="fu">table</span>(census2021teaching<span class="sc">$</span>Poor_health, census2021teaching<span class="sc">$</span>approx_social_grade)</span>
<span id="cb57-498"><a href="#cb57-498"></a></span>
<span id="cb57-499"><a href="#cb57-499"></a><span class="in">```</span></span>
<span id="cb57-500"><a href="#cb57-500"></a></span>
<span id="cb57-501"><a href="#cb57-501"></a><span class="fu">##### b) chi square test on health and our 5 other variables</span></span>
<span id="cb57-502"><a href="#cb57-502"></a></span>
<span id="cb57-505"><a href="#cb57-505"></a><span class="in">```{r}</span></span>
<span id="cb57-506"><a href="#cb57-506"></a><span class="fu">chisq.test</span>(tabulation.health_hours)</span>
<span id="cb57-507"><a href="#cb57-507"></a><span class="fu">chisq.test</span>(tabulation.health_age)</span>
<span id="cb57-508"><a href="#cb57-508"></a><span class="fu">chisq.test</span>(tabulation.health_sex)</span>
<span id="cb57-509"><a href="#cb57-509"></a><span class="fu">chisq.test</span>(tabulation.health_ethnicity)</span>
<span id="cb57-510"><a href="#cb57-510"></a><span class="fu">chisq.test</span>(tabulation.health_classes)</span>
<span id="cb57-511"><a href="#cb57-511"></a></span>
<span id="cb57-512"><a href="#cb57-512"></a><span class="in">```</span></span>
<span id="cb57-513"><a href="#cb57-513"></a><span class="fu">## 5 Regression model</span></span>
<span id="cb57-514"><a href="#cb57-514"></a></span>
<span id="cb57-515"><a href="#cb57-515"></a><span class="fu">### 5.1 Recode variables as factors with labels</span></span>
<span id="cb57-516"><a href="#cb57-516"></a></span>
<span id="cb57-519"><a href="#cb57-519"></a><span class="in">```{r}</span></span>
<span id="cb57-520"><a href="#cb57-520"></a>census2021teaching<span class="sc">$</span>hours_per_week_worked <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb57-521"><a href="#cb57-521"></a>  census2021teaching<span class="sc">$</span>hours_per_week_worked,</span>
<span id="cb57-522"><a href="#cb57-522"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb57-523"><a href="#cb57-523"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-15"</span>, <span class="st">"16-30"</span>, <span class="st">"31-48"</span>, <span class="st">"49+"</span>, <span class="st">"Does not apply"</span>)</span>
<span id="cb57-524"><a href="#cb57-524"></a>)</span>
<span id="cb57-525"><a href="#cb57-525"></a></span>
<span id="cb57-526"><a href="#cb57-526"></a>census2021teaching<span class="sc">$</span>resident_age_7d <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb57-527"><a href="#cb57-527"></a>  census2021teaching<span class="sc">$</span>resident_age_7d,</span>
<span id="cb57-528"><a href="#cb57-528"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb57-529"><a href="#cb57-529"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-15"</span>, <span class="st">"16-24"</span>, <span class="st">"25-34"</span>, <span class="st">"35-44"</span>, <span class="st">"45-54"</span>, <span class="st">"55-64"</span>, <span class="st">"65+"</span>, <span class="st">"Not applicable"</span>)</span>
<span id="cb57-530"><a href="#cb57-530"></a>)</span>
<span id="cb57-531"><a href="#cb57-531"></a></span>
<span id="cb57-532"><a href="#cb57-532"></a>census2021teaching<span class="sc">$</span>ethnic_group_tb_6a <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb57-533"><a href="#cb57-533"></a>  census2021teaching<span class="sc">$</span>ethnic_group_tb_6a,</span>
<span id="cb57-534"><a href="#cb57-534"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb57-535"><a href="#cb57-535"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Asian"</span>, <span class="st">"Black"</span>, <span class="st">"Mixed"</span>, <span class="st">"White"</span>, <span class="st">"Other"</span>, <span class="st">"Does not apply"</span>)</span>
<span id="cb57-536"><a href="#cb57-536"></a>)</span>
<span id="cb57-537"><a href="#cb57-537"></a></span>
<span id="cb57-538"><a href="#cb57-538"></a>census2021teaching<span class="sc">$</span>approx_social_grade <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb57-539"><a href="#cb57-539"></a>  census2021teaching<span class="sc">$</span>approx_social_grade,</span>
<span id="cb57-540"><a href="#cb57-540"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb57-541"><a href="#cb57-541"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Higher, intermediate managers"</span>,</span>
<span id="cb57-542"><a href="#cb57-542"></a>             <span class="st">"Supervisory, junior managers"</span>,</span>
<span id="cb57-543"><a href="#cb57-543"></a>             <span class="st">"Skilled manual"</span>,</span>
<span id="cb57-544"><a href="#cb57-544"></a>             <span class="st">"Semi-skilled, unskilled manual"</span>,</span>
<span id="cb57-545"><a href="#cb57-545"></a>             <span class="st">"Not applicable"</span>)</span>
<span id="cb57-546"><a href="#cb57-546"></a>)</span>
<span id="cb57-547"><a href="#cb57-547"></a></span>
<span id="cb57-548"><a href="#cb57-548"></a>census2021teaching<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb57-549"><a href="#cb57-549"></a>  census2021teaching<span class="sc">$</span>sex,</span>
<span id="cb57-550"><a href="#cb57-550"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb57-551"><a href="#cb57-551"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb57-552"><a href="#cb57-552"></a>)</span>
<span id="cb57-553"><a href="#cb57-553"></a></span>
<span id="cb57-554"><a href="#cb57-554"></a><span class="in">```</span></span>
<span id="cb57-555"><a href="#cb57-555"></a></span>
<span id="cb57-556"><a href="#cb57-556"></a><span class="fu">### 5.2 Pick references that are central or policy relevant</span></span>
<span id="cb57-557"><a href="#cb57-557"></a></span>
<span id="cb57-560"><a href="#cb57-560"></a><span class="in">```{r}</span></span>
<span id="cb57-561"><a href="#cb57-561"></a>census2021teaching<span class="sc">$</span>hours_per_week_worked <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>hours_per_week_worked, <span class="at">ref =</span> <span class="st">"31-48"</span>)</span>
<span id="cb57-562"><a href="#cb57-562"></a>census2021teaching<span class="sc">$</span>resident_age_7d         <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>resident_age_7d,         <span class="at">ref =</span> <span class="st">"45-54"</span>)</span>
<span id="cb57-563"><a href="#cb57-563"></a>census2021teaching<span class="sc">$</span>sex                  <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>sex,                  <span class="at">ref =</span> <span class="st">"Male"</span>)</span>
<span id="cb57-564"><a href="#cb57-564"></a>census2021teaching<span class="sc">$</span>ethnic_group_tb_6a            <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>ethnic_group_tb_6a,            <span class="at">ref =</span> <span class="st">"White"</span>)</span>
<span id="cb57-565"><a href="#cb57-565"></a>census2021teaching<span class="sc">$</span>approx_social_grade         <span class="ot">&lt;-</span> <span class="fu">relevel</span>(census2021teaching<span class="sc">$</span>approx_social_grade,         <span class="at">ref =</span> <span class="st">"Higher, intermediate managers"</span>)</span>
<span id="cb57-566"><a href="#cb57-566"></a></span>
<span id="cb57-567"><a href="#cb57-567"></a><span class="in">```</span></span>
<span id="cb57-568"><a href="#cb57-568"></a></span>
<span id="cb57-569"><a href="#cb57-569"></a><span class="fu">### 5.3 Fit logistic regression </span></span>
<span id="cb57-570"><a href="#cb57-570"></a></span>
<span id="cb57-571"><a href="#cb57-571"></a></span>
<span id="cb57-574"><a href="#cb57-574"></a><span class="in">```{r}</span></span>
<span id="cb57-575"><a href="#cb57-575"></a>model_health <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb57-576"><a href="#cb57-576"></a>  Poor_health <span class="sc">~</span> hours_per_week_worked <span class="sc">+</span> resident_age_7d <span class="sc">+</span> sex <span class="sc">+</span> ethnic_group_tb_6a <span class="sc">+</span> approx_social_grade,</span>
<span id="cb57-577"><a href="#cb57-577"></a>  <span class="at">data =</span> census2021teaching,</span>
<span id="cb57-578"><a href="#cb57-578"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb57-579"><a href="#cb57-579"></a>)</span>
<span id="cb57-580"><a href="#cb57-580"></a></span>
<span id="cb57-581"><a href="#cb57-581"></a><span class="in">```</span></span>
<span id="cb57-582"><a href="#cb57-582"></a><span class="fu">#### Obtain summary results of the logistic regression</span></span>
<span id="cb57-583"><a href="#cb57-583"></a></span>
<span id="cb57-586"><a href="#cb57-586"></a><span class="in">```{r}</span></span>
<span id="cb57-587"><a href="#cb57-587"></a><span class="fu">summary</span>(model_health)</span>
<span id="cb57-588"><a href="#cb57-588"></a></span>
<span id="cb57-589"><a href="#cb57-589"></a><span class="in">```</span></span>
<span id="cb57-590"><a href="#cb57-590"></a></span>
<span id="cb57-591"><a href="#cb57-591"></a></span>
<span id="cb57-592"><a href="#cb57-592"></a></span>
<span id="cb57-593"><a href="#cb57-593"></a></span>
<span id="cb57-594"><a href="#cb57-594"></a></span>
<span id="cb57-595"><a href="#cb57-595"></a></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>